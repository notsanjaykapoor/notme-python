{% extends "base.html" %}

{% block content %}

<div class="container grid grid-cols-12">
  <div class="col-span-12 mt-10">
    <h3 class="font-bold text-center">
      {{ app_name }}
    </h3>
  </div>
  <div class="col-start-2 col-span-10 mt-2 opacity-50 text-center text-xs text-zinc-400">
    @{{ app_version }}
  </div>
</div>

<form action="/rag/corpuses" method="get" id="rag-corpus-search">
  <div class="container grid grid-cols-12 mt-10">
    <div class="col-start-2 col-span-4 font-normal text-xs mx-5">
      <input type="search" name="query" value="{{query}}" placeholder="{{prompt_text}}" autocomplete="off" class="peer px-0 py-2.5 mx-0 h-full w-full border-b bg-transparent font-sans text-blue-gray-700 outline outline-0 transition-all placeholder-shown:border-blue-gray-200 focus:border-pink-600 focus:outline-0 disabled:border-0 disabled:bg-blue-gray-50">
    </div>
  </div>
</form>

<div class="container grid grid-cols-12 mt-10" id="corpus-table">
  <table class="col-start-2 col-span-12">
    <thead class="font-normal text-left text-xs leading-6 text-zinc-800">
      <tr>
        <th class="p-4 pr-6">name</th>
        <th class="p-4 pr-6">files</th>
        <th class="p-4 pr-6">docs</th>
        <th class="p-4 pr-6">nodes</th>
        <th class="p-4 pr-6">model</th>
        <th class="p-4 pr-6">dims</th>
        <th class="p-4 pr-6">splitter</th>
        <th class="p-4 pr-6">epoch</th>
        <th class="p-4 pr-6">state</th>
        <th class="p-4 pr-6">id</th>
      </tr>
    </thead>
    <tbody>
      {% for corpus in corpus_list %}
        <tr class="group hover:bg-zinc-50 odd:bg-white even:bg-slate-50 text-xs">
          <td class="p-4 pr-6 font-normal">
            <a href="/rag/query?corpus={{corpus.name}}" class="font-semibold text-blue-700">{{corpus.name}}</a>
          <td class="p-4 pr-6 font-normal">{{corpus.files_count}}</td>
          <td class="p-4 pr-6 font-normal">{{corpus.docs_count}}</td>
          <td class="p-4 pr-6 font-norma">{{corpus.nodes_count}}</td>
          <td class="p-4 pr-6 font-norma">{{corpus.embed_model}}</td>
          <td class="p-4 pr-6 font-norma">{{corpus.embed_dims}}</td>
          <td class="p-4 pr-6 font-norma">{{corpus.splitter}}</td>
          <td class="p-4 pr-6 font-normal">
            {% if corpus.state == "ingested" %}
              <a href="/rag/ingest?corpus_id={{corpus.id}}" class="font-black text-orange-700">
                {{corpus.epoch}}
              </a>
            {% else %}
              <span class="text-black-700 italic">
                {{corpus.epoch}}
              </span>
            {% endif %}
          </td>
          <td class="p-4 pr-6 font-normal">{{corpus.state}}</td>
          <td class="p-4 pr-6 font-normal">{{corpus.id}}</td>
        </tr>
        {% endfor %}
    </tbody>
  </table>
</div>

{% endblock %}
